# Malware Analysis Report Template

Use this structure for professional technical malware analysis reports.

## Report Structure

```markdown
# Malware Analysis Report: [MALWARE_NAME/FAMILY]

**Analysis Date:** YYYY-MM-DD  
**Analyst:** [NAME]  
**Classification:** [Trojan/Ransomware/RAT/Stealer/Loader/etc.]  
**Severity:** [Critical/High/Medium/Low]

---

## Executive Summary

[2-3 sentences: What is this malware, what does it do, who is likely behind it, and what's the impact. Write for non-technical stakeholders.]

---

## Sample Information

| Property | Value |
|----------|-------|
| Filename | |
| File Size | |
| File Type | |
| MD5 | |
| SHA1 | |
| SHA256 | |
| Compile Timestamp | |
| First Seen | |

---

## Threat Intelligence

### Verdict: [MALICIOUS/SUSPICIOUS/UNKNOWN]

### Source Summary

| Source | Status | Key Findings |
|--------|--------|--------------|
| MalwareBazaar | Found/Not Found | [Family name, tags, first seen] |
| ThreatFox | Found/Not Found | [Threat type, malware family, confidence] |
| URLhaus | Found/Not Found | [Associated URLs, payload info] |
| VirusTotal | [X/Y] detections | [Top threat label, tags] |
| AbuseIPDB | [Score]% confidence | [Total reports, ISP, country] |

### Attribution & Classification

| Property | Value |
|----------|-------|
| Malware Family | [From TI sources] |
| Threat Type | [Trojan, Ransomware, Stealer, etc.] |
| First Seen (Wild) | [Earliest date from TI] |
| Last Seen | [Most recent activity] |
| Delivery Method | [If known from MalwareBazaar] |
| Associated Campaigns | [If any] |

### Related IOCs from TI

[List any additional IOCs discovered through TI enrichment - related samples, C2s, etc.]

---

## Key Findings

[Bullet points of the most significant discoveries - behaviors, C2, attribution indicators, etc.]

---

## Technical Analysis

### Static Analysis

#### File Characteristics
[PE headers, sections, entropy, packing detection, imports/exports of interest]

#### Code Analysis
[Key functions, algorithms, obfuscation techniques, notable strings]

### Dynamic Analysis

#### Execution Flow
[Startup behavior, persistence mechanisms, privilege escalation]

#### Network Activity
[C2 communication, protocols, domains/IPs contacted]

#### System Modifications
[Files created/modified, registry changes, processes spawned]

---

## MITRE ATT&CK Mapping

| Tactic | Technique | ID | Description |
|--------|-----------|----|----|
| | | | |

---

## Indicators of Compromise

### Network Indicators
```
[Defanged URLs, domains, IPs]
```

### Host Indicators
```
[File hashes, paths, registry keys, mutexes]
```

---

## Detection Opportunities

### YARA Rule
```yara
rule [MALWARE_NAME] {
    meta:
        description = ""
        author = ""
        date = ""
        hash = ""
    
    strings:
        $s1 = ""
        
    condition:
        uint16(0) == 0x5A4D and all of them
}
```

### Sigma Rule (Optional)
[For behavioral detection]

---

## Recommendations

1. [Immediate actions]
2. [Detection deployment]
3. [Hunting queries]

---

## References

- [Links to related reports, vendor analysis, etc.]

---

## Appendix

### A. Full Strings List
[If relevant]

### B. Complete IOC List
[Structured format for automated ingestion]

### C. Raw Threat Intelligence Data
[JSON output from triage.py for reference]
```

## Writing Guidelines

1. **Be precise**: Use exact values, timestamps, and hashes
2. **Show your work**: Include screenshots, code snippets, disassembly where relevant
3. **Defang IOCs**: Always defang URLs, IPs, and domains in the report body
4. **Attribution carefully**: State confidence levels (low/medium/high) for any attribution claims
5. **Actionable output**: Every report should enable defenders to detect and respond
6. **TI enrichment**: Always run triage.py first and include findings in the Threat Intelligence section

## Threat Intelligence Workflow

1. Run triage on the sample hash:
   ```bash
   python3 scripts/triage.py -t file /path/to/sample -f json > ti_results.json
   ```

2. Extract key findings for the report:
   - Verdict (malicious/suspicious/unknown)
   - Malware family names from all sources
   - Detection rates
   - First/last seen dates
   - Related IOCs

3. Cross-reference findings:
   - Do multiple sources agree on family?
   - Any conflicting information?
   - What's the confidence level?

4. Include raw JSON in Appendix C for reproducibility
